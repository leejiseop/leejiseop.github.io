---
layout: default
title: 4장. 라우팅
parent: 하루 3분 네트워크 교실
---

> # 4장. 라우팅

- MAC - 같은 네트워크 내에서의 수신처를 결정한다 (그때그때 다음에 보낼 장소 - 계속 바뀜)
- IP - 수신처의 컴퓨터를 결정한다 (최종 수신처)
- 경로는 라우터가 정한다 (총 경로가 아니라, 그때그때 다음에 어디로 갈 지)
- 홉 바이 홉 - 그때 그때 다음 길 제시하며 가는 방식
- 다른 네트워크와 소통하려면 무조건 라우터를 거쳐야 한다. 같은 세그먼트?(허브) 안이더라도!
    - "수신처가 다른 네트워크에 있다면 라우터로 송신한다. 같은 네트워크에 있다면 직접 송신한다" 원칙
    - 그 라우터 : 디폴트 게이트웨이 (네트워크의 출입구! 최초로 데이터를 보내는 수신처)
        - 다른 네트워크에 송신할 때, 디폴트 게이트웨이로 ARP를 수행한다
- 라우터는 각 네트워크의 경계상에 위치해 있기 때문에, 복수의 인터페이스를 가질 수 있다 - 복수의 네트워크를 연결한다
    - 각각의 인터페이스에 논리주소 IP 설정되어있음
    - 각각의 인터페이스가 각각의 네트워크에 소속되어있다
    - 데이터 전달 뿐 만 아니라, 필터링 역할도 함. 데이터 분류
- 라우팅 테이블 - 최적 경로의 지도 - 가장 중요한 요소!
    - 수신처 네트워크까지의 거리
    - 다음에 도달하는 라우터
    - 그 라우터에 연결되어있는 자신의 인터페이스
    - 최장일치의 룰. 롱기스트 매치 - 데이터그램 IP 주소로부터 라우팅 테이블의 수신처 네트워크 주소를 결정함. 다음 라우터와 송신 인터페이스를 결정한다.
        - 수신처 IP주소와 수신처 네트워크 주소를 비교. 앞에서부터 가장 길게 매치되는 곳으로 보낸다
    1. 패킷 수신, 수신처 주소 비교
    2. 어느 라우터로 보낼지, 그러려면 어느 인터페이스로 보내야 하는지 결정하고 보냄
- 라우터는 브로드캐스트 도메인을 나눈다.
    - 브로드캐스트 도메인 - 브로드캐스트가 도달하는 범위
    - 충돌 도메인 - 충돌이 일어날 수 있는 범위. 스위치가 나눈다
    - 허브는 뭐 못나눔
    - 브로드캐스트 도메인 = 네트워크. 거의 같은 의미
- 다른 네트워크로 송신할 때
    - 브로드캐스트 ARP 해서 게이트웨이의 MAC을 얻는게 아니라,
    - 디폴트 게이트웨이 주소 따라가서 거기다가만 ARP 요청을 한다(?)
- 스위치는 수신처를 모르면 플러딩하지만, 라우터는 파기한다
- 라우터가 알고있는 경로 중에서 최적의 경로를 선택해서 라우팅 테이블을 작성한다
    - 다른 네트워크의 모든 경로를 알아내는 방법
        - 정적 라우팅
            - 관리자가 수동으로 경로를 입력한다. "이 네트워크 가려면 이 경로를 사용하세요"
                - 수신처 - 네트워크 A
                - 다음 라우터 - 라우터 X
                - 송신 인터페이스 - 2번
                - 메트릭 - 1
            - 입력한 경로를 사용할 수 없게 되는 경우, 직접 새로 갱신해줘야 함
        - 동적 라우팅
            - 라우터끼리 정보를 교환해서 모든 경로 중 최적의 경로를 자동으로 선택하여 라우팅 테이블을 작성한다
                - 장점
                    - 자동으로 장애를 제거한다!
                - 단점
                    - 서로 정보를 교환하는 만큼, 회선의 압박 증가, 데이터 전송 분량 감소
                        - 그러므로, 저속 회선을 사용하는 경우 주의!
                    - 최적의 경로를 계산해야 하므로 라우터의 처리능력이 중요함
                        - 능력이 낮으면, 데이터의 전송처리가 늦어짐
                    - ★ 모든 라우터가 동일한 정보를 가져야 한다!
                        - 모든 라우터가 동일한 상태 - 컨버전스(convergense)
- 중복성? - 네트워크 장애에 대응할 수 있도록 중복되는 여분의 경로가 있는 것
- 라우팅 프로토콜? - 근접해 있는 라우터 간의 네트워크 정보를 서로 교환하는 것
    - 교환한 정보로 라우팅 테이블을 변경한다
    - 라우팅 업데이트 - 교환하는 정보
        - 라우팅 테이블을 통째로 교환한다. 30초에 한번씩.
            - 6번 수신받지 않으면 뭔가 장애가 발생했다고 해석. 그 라우터를 사용하는 모든 경로들 파기
- 자율화 시스템? - 하나의 관리 단체에 의해 관리되는 네트워크 집합체
    - 인터넷에는 너무 많은 네트워크들이 존재하기 때문에,
        
        같은 조직이 관리한다면 복수의 네트워크를 AS로 통합해서 다룬다 → 큰 단위의 라우팅
        
    - 수신처의 AS에 전달하는 라우팅 수행 → AS 내부에서 각 네트워크에 전달하는 라우팅 수행
- 라우팅 프로토콜의 종류
    - AS 간 라우팅, EGP (Exterior Gateway Protocol), 표준 : BGP
    - AS 내부 라우팅, IGP (Interior Gateway Protocol), 표준 : 관리자가 AS 상태에 맞춰서 프로토콜 선택
- 메트릭 - 최적의 경로를 결정할 때의 판단기준
    - 최소의 메트릭을 갖는 경로가 최적의 경로
    - 최적의 경로가 아닌 경로는 라우팅 테이블에 기재하지 않는다
    - 목적지: 네트워크A, 다음라우터: 라우터X, 거리: 3
    - 홉 수 : 통과하는 라우터 수
- RIP 강의 듣기

- ICMP - 인터넷 제어 메시지 프로토콜. 에러 보고 프로토콜
    - 네트워크의 제어 및 관리를 위해 주고받는 메세지
    - ip 데이터그램에 icmp 메세지를 넣는다
        - 이더넷 프레임( ip 패킷( 세그먼트( 데이터( asdf ) ) ) )
        - 이더넷 프레임( ip 헤더, ICMP 메세지)
            - ICMP 메세지 (타입, 코드, 체크섬, 옵션, 데이터)
        - 타입은 icmp의 종류, 코드는 그 상세 내용
    - 송신불능 메세지를 받으면 어떻게 처리할 지는 어플리케이션 맘
    - ICMP에는 크게 두 종류가 있다. query와 error 각각 여러가지의 타입이 존재한다.
        - Query 메세지 - 상태를 조사하기 위해
        - Error 메세지 - 에러 통지
- IP 데이터그램 헤더의 TTL - 라우터 하나 건널 때 마다 1씩 차감. 0이되면 파기
    - 무한루프 방지
    - 파기되면 송신처에 TimeExceeded ICMP를 보낸다
    - traceroute - 어느 라우터 경로를 거쳐서 갔는지 알 수 있게 해준다
        - IP주소를 알 수 있으므로 보안에 주의!
    - ping - 응답시간 측정
---
layout: default
title: 2. 스프링 핵심 원리 이해1 - 예제 만들기
parent: 스프링 핵심 원리 - 기본편
---

# 스프링 핵심 원리 이해1 - 예제 만들기
{: .no_toc }

1. TOC
{:toc}

## 인터페이스 의존

- 인터페이스에만 의존하도록 코드 변경
```java
public class OrderServiceImpl implements OrderService {
//private final DiscountPolicy discountPolicy = new RateDiscountPolicy();
private DiscountPolicy discountPolicy;
}
```

- 실행하면 당연히 NPE 발생
  - 구현체가 없는데 어떻게 코드를 실행하나?
  - 외부에서 discountPolicy로 누군가 주입해주어야한다

## AppConfig

```java
public class AppConfig {
    public MemberService memberService() {
        return new MemberServiceImpl(new MemoryMemberRepository());
    }
    public OrderService orderService() {
        return new OrderServiceImpl(
        new MemoryMemberRepository(),
        new FixDiscountPolicy());
    }
}
```

- AppConfig는 애플리케이션의 실제 동작에 필요한 **구현 객체를 생성**한다.
  - `MemberServiceImpl`
  - `MemoryMemberRepository`
  - `OrderServiceImpl`
  - `FixDiscountPolicy`

- AppConfig는 생성한 객체 인스턴스의 참조(레퍼런스)를 **생성자를 통해서 주입(연결)**해준다.
  - `MemberServiceImpl`, `MemoryMemberRepository`
  - `OrderServiceImpl`, `MemoryMemberRepository` , `FixDiscountPolicy`

```java
public class MemberServiceImpl implements MemberService {

    private final MemberRepository memberRepository;
    public MemberServiceImpl(MemberRepository memberRepository) {
        this.memberRepository = memberRepository;
    }

    public void join(Member member) {
        memberRepository.save(member);
    }
    public Member findMember(Long memberId) {
        return memberRepository.findById(memberId);
    }
}
```

- `MemberServiceImpl` 은 `MemoryMemberRepository` 를 의존하지 않는다
  - `MemberRepository` 인터페이스만 의존한다
  - DIP, 관심사의 분리 완성